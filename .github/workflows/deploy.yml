# Название вашего рабочего процесса
name: Deploy to Production

# Триггер: запускать при каждом push в ветку 'main'
on:
  push:
    branches:
      - main  # Или 'master', в зависимости от вашей основной ветки

# Задачи, которые нужно выполнить
jobs:
  deploy:
    # Название задачи
    name: Deploy
    # Указываем, что задача должна выполняться на вашем сервере
    # 'self-hosted' — это метка по умолчанию для таких раннеров
    runs-on: self-hosted

    # Шаги выполнения
    steps:
      # Шаг 1: Получение последних изменений из репозитория
      # GitHub Actions делает это автоматически, но лучше указать явно
      - name: Checkout code
        uses: actions/checkout@v3

      # Шаг 2: Выполнение ваших команд
      - name: Stop, Pull, Build and Run Docker Compose
        # Переходим в директорию с вашим проектом на сервере
        # Путь нужно будет заменить на ваш реальный
        working-directory: /path/to/your/project
        run: |
          docker-compose stop
          git pull
          docker-compose build
          docker-compose up -d
